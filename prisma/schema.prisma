generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("POSTGRES_URL")
}

model Restaurant {
  id                 String                     @id @default(cuid())
  name               String
  description        String
  logo               String?
  coverImage         String?
  address            String
  phone              String
  email              String
  website            String?
  instagram          String?
  facebook           String?
  twitter            String?
  currency           String                     @default("TRY")
  language           String                     @default("tr")
  createdAt          DateTime                   @default(now())
  updatedAt          DateTime                   @updatedAt
  coverImagePublicId String?
  logoPublicId       String?
  menuCategories     MenuCategory[]
  menuItems          MenuItem[]
  operatingHours     RestaurantOperatingHours[]

  @@map("restaurants")
}

model RestaurantOperatingHours {
  id           String     @id @default(cuid())
  restaurantId String
  restaurant   Restaurant @relation(fields: [restaurantId], references: [id], onDelete: Cascade)
  dayOfWeek    String
  openTime     String
  closeTime    String
  isClosed     Boolean    @default(false)

  @@unique([restaurantId, dayOfWeek])
  @@map("restaurant_operating_hours")
}

model MenuCategory {
  id           String     @id @default(cuid())
  restaurantId String
  restaurant   Restaurant @relation(fields: [restaurantId], references: [id], onDelete: Cascade)
  name         String
  description  String?
  icon         String?
  order        Int        @default(0)
  isActive     Boolean    @default(true)
  createdAt    DateTime   @default(now())
  updatedAt    DateTime   @updatedAt
  iconPublicId String?
  menuItems    MenuItem[]

  @@map("menu_categories")
}

model MenuItem {
  id            String       @id @default(cuid())
  restaurantId  String
  restaurant    Restaurant   @relation(fields: [restaurantId], references: [id], onDelete: Cascade)
  categoryId    String
  category      MenuCategory @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  name          String
  description   String
  price         Float
  image         String?
  imagePublicId String?
  order         Int          @default(0)
  isActive      Boolean      @default(true)
  createdAt     DateTime     @default(now())
  updatedAt     DateTime     @updatedAt

  @@index([isActive, order])
  @@index([restaurantId, isActive])
  @@index([categoryId, isActive])
  @@map("menu_items")
}
